<!DOCTYPE html>

<html lang="es">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>{% block title %}Panel de Padre{% endblock %}</title>



    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">



    <style>

        /* Variables CSS usando la paleta de colores del diseño */

        :root {

            --accent1: #F95738;

            --accent2: #EE964B;

            --accent3: #F4D35E;

            --accent4: #0D3B66;

            --light: #FAF0CA;

            --white: #FFFFFF;

            --black: #333333;

            --gray: #666666;

            --light-gray: #F8F9FA;

            --border: #E9ECEF;

            --card-bg: #FFFFFF;

            --header-bg: #FFFFFF;

            --main-bg: #F8F9FA;

            --shadow: 0 5px 15px rgba(0, 0, 0, 0.08);

            --shadow-hover: 0 8px 25px rgba(0, 0, 0, 0.15);

            --gradient-primary: linear-gradient(135deg, var(--accent4), #1a5080);

            --gradient-secondary: linear-gradient(135deg, var(--accent3), #e9c440);

            --gradient-accent: linear-gradient(135deg, var(--accent1), #ff6b4a);

            --sidebar-width: 280px;

            --transition-speed: 0.3s;

        }



        /* Estilos del Sidebar */

        .sidebar {

            background: var(--gradient-primary);

            height: 100vh;

            position: fixed;

            top: 0;

            left: 0;

            width: var(--sidebar-width);

            z-index: 1000;

            transition: transform var(--transition-speed) ease;

            box-shadow: 2px 0 20px rgba(0, 0, 0, 0.1);

            backdrop-filter: blur(10px);

            display: flex;

            flex-direction: column;

            overflow: hidden;

        }



        .sidebar-header {

            background: rgba(255, 255, 255, 0.1);

            padding: 1.5rem;

            border-bottom: 1px solid rgba(255, 255, 255, 0.1);

            text-align: center;

        }



        .sidebar-header h1 {

            color: var(--white);

            font-size: 1.1rem;

            font-weight: 700;

            margin: 0;

            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);

        }



        .sidebar-nav {

            flex: 1;

            padding: 1rem 0;

            overflow-y: auto;

        }



        .sidebar-group {

            margin-bottom: 1.5rem;

            padding: 0 1rem;

        }



        .sidebar-group:last-child {

            margin-bottom: 0;

        }



        .nav-link {

            display: flex;

            align-items: center;

            padding: 0.75rem 1rem;

            color: rgba(255, 255, 255, 0.8);

            text-decoration: none;

            transition: all var(--transition-speed) ease;

            border-radius: 10px;

            margin-bottom: 0.25rem;

            position: relative;

            font-weight: 500;

        }



        .nav-link:hover {

            background: rgba(255, 255, 255, 0.1);

            color: var(--white);

            transform: translateX(5px);

        }



        .nav-link.active {

            background: var(--accent3);

            color: var(--black);

            box-shadow: 0 4px 15px rgba(244, 211, 94, 0.3);

        }



        .nav-link i {

            width: 20px;

            margin-right: 0.75rem;

            text-align: center;

            font-size: 1rem;

        }



        .sidebar-footer {

            background: rgba(255, 255, 255, 0.1);

            padding: 1.5rem;

            border-top: 1px solid rgba(255, 255, 255, 0.1);

        }



        .user-avatar {

            background: var(--accent3);

            color: var(--black);

            font-weight: 600;

        }



        .user-info p {

            color: var(--white);

        }



        .user-info .text-white-50 {

            color: rgba(255, 255, 255, 0.7) !important;

        }



        .badge-notification {

            background: var(--accent1);

            color: var(--white);

            border-radius: 50%;

            padding: 2px 6px;

            font-size: 0.7rem;

            font-weight: 600;

            margin-left: auto;

        }



        /* Main Content */

        .main-content {

            margin-left: var(--sidebar-width);

            min-height: 100vh;

            background: var(--main-bg);

        }



        .content-wrapper {

            padding: 2rem;

        }



        /* Mobile Responsive */

        @media (max-width: 991.98px) {

            .sidebar {

                transform: translateX(-100%);

            }



            .sidebar.show {

                transform: translateX(0);

            }



            .main-content {

                margin-left: 0;

            }



            .sidebar-overlay {

                position: fixed;

                top: 0;

                left: 0;

                width: 100%;

                height: 100%;

                background: rgba(0, 0, 0, 0.5);

                z-index: 999;

                display: none;

            }



            .sidebar-overlay.show {

                display: block;

            }

        }



        /* Estilos adicionales para el contenido */

        .alert {

            border-radius: 10px;

            border: none;

            box-shadow: var(--shadow);

        }



        .btn {

            border-radius: 8px;

            font-weight: 500;

            transition: all var(--transition-speed) ease;

        }



        .btn:hover {

            transform: translateY(-2px);

            box-shadow: var(--shadow-hover);

        }

    </style>



    {% block extra_css %}{% endblock %}

</head>

<body class="bg-light">



    <!-- Sidebar -->

    <aside id="sidebar" class="sidebar text-white d-flex flex-column">

        <div class="sidebar-header">

            <h1 class="fw-bold text-uppercase">Panel de Padre</h1>

        </div>



        <nav class="sidebar-nav" aria-label="Navegación principal">

            <div class="sidebar-group">

                <a href="{{ url_for('padre.dashboard') }}" class="nav-link rounded {% if request.endpoint == 'padre.dashboard' %}active{% endif %}">

                    <i class="fas fa-home"></i>Inicio

                </a>

            </div>



            <div class="sidebar-group">

                {% if current_user.has_permission('ver_calificaciones_hijo') %}

                <a href="#" class="nav-link rounded {% if 'calificaciones' in request.endpoint %}active{% endif %}">

                    <i class="fas fa-poll"></i>Calificaciones

                </a>

                {% endif %}

                {% if current_user.has_permission('ver_horario_hijo') %}

                <a href="#" class="nav-link rounded {% if 'horario' in request.endpoint %}active{% endif %}">

                    <i class="fas fa-calendar-alt"></i>Horario de Clases

                </a>

                {% endif %}

            </div>



            <div class="sidebar-group">

                <a href="{{ url_for('padre.comunicaciones') }}" class="nav-link rounded {% if request.endpoint == 'padre.comunicaciones' %}active{% endif %}">

                    <i class="fas fa-envelope"></i>Comunicaciones

                    {% if unread_messages|default(0) > 0 %}

                    <span class="badge-notification">{{ unread_messages|default(0) }}</span>

                    {% endif %}

                </a>

            </div>



            <div class="sidebar-group">

                <a href="#" class="nav-link rounded {% if 'perfil' in request.endpoint %}active{% endif %}">

                    <i class="fas fa-user-circle"></i>Mi Perfil

                </a>

                <a href="#" class="nav-link rounded {% if 'soporte' in request.endpoint %}active{% endif %}">

                    <i class="fas fa-question-circle"></i>Soporte

                </a>

            </div>

        </nav>



        <div class="sidebar-footer d-flex flex-column align-items-stretch justify-content-center">

            <div class="d-flex align-items-center justify-content-between mb-3">

                <div class="d-flex align-items-center">

                    <div class="user-avatar rounded-circle d-flex align-items-center justify-content-center me-3" 

                         style="width: 38px; height: 38px;">

                        <i class="fas fa-user text-dark"></i>

                    </div>

                    <div class="user-info">

                        <p class="fw-semibold m-0 small">{{ current_user.nombre_completo }}</p>

                        <p class="small text-white-50 m-0">Padre</p>

                    </div>

                </div>

                <a href="#" class="btn btn-sm btn-light">Perfil</a>

            </div>



            <div class="d-flex">

                <a href="{{ url_for('auth.logout') }}" class="btn btn-sm btn-outline-light w-100">

                    <i class="fas fa-sign-out-alt me-2"></i>Cerrar Sesión

                </a>

            </div>

        </div>

    </aside>



    <!-- Main Content -->

    <div class="main-content d-flex flex-column">

        <!-- Mobile Header -->

        <header class="d-lg-none p-3 sticky-top bg-white border-bottom shadow-sm">

            <div class="d-flex align-items-center justify-content-between">

                <div class="d-flex align-items-center">

                    <button class="btn" type="button" id="sidebarToggle" aria-label="Alternar menú">

                        <i class="fas fa-bars"></i>

                    </button>

                    <h5 class="m-0 ms-3 text-dark fw-bold">Panel de Padre</h5>

                </div>

            </div>

        </header>

        

        <!-- Content -->

        <main class="content-wrapper flex-grow-1">



            <!-- Mensajes flash -->

            {% with messages = get_flashed_messages(with_categories=true) %}

                {% if messages %}

                    {% for category, message in messages %}

                        <div class="alert alert-{{ category }} alert-dismissible fade show mb-4" role="alert">

                            <i class="fas fa-{% if category == 'success' %}check-circle{% elif category == 'danger' %}exclamation-circle{% elif category == 'warning' %}exclamation-triangle{% else %}info-circle{% endif %} me-2"></i>

                            {{ message }}

                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>

                        </div>

                    {% endfor %}

                {% endif %}

            {% endwith %}

            

            <!-- Contenido principal -->

            {% block content %}{% endblock %}

        </main>

    </div>



    <!-- Overlay para móvil -->

    <div class="sidebar-overlay d-lg-none"></div>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>

        document.addEventListener('DOMContentLoaded', function() {

            const sidebarToggle = document.getElementById('sidebarToggle');

            const sidebar = document.getElementById('sidebar');

            const overlay = document.querySelector('.sidebar-overlay');



            if (sidebarToggle && sidebar) {

                sidebarToggle.addEventListener('click', function() {

                    sidebar.classList.toggle('show');

                    if (overlay) {

                        overlay.classList.toggle('show');

                    }

                });

            }



            if (overlay) {

                overlay.addEventListener('click', function() {

                    sidebar.classList.remove('show');

                    overlay.classList.remove('show');

                });

            }



            document.addEventListener('click', function(event) {

                if (window.innerWidth < 992 && sidebar.classList.contains('show') && !sidebar.contains(event.target) && !sidebarToggle.contains(event.target)) {

                    sidebar.classList.remove('show');

                    if (overlay) {

                        overlay.classList.remove('show');

                    }

                }

            });



            // Cerrar sidebar al redimensionar ventana

            window.addEventListener('resize', function() {

                if (window.innerWidth >= 992) {

                    sidebar.classList.remove('show');

                    if (overlay) {

                        overlay.classList.remove('show');

                    }

                }

            });

        });

    </script>

</body>

</html>
